const webpack = require( 'webpack' )
const fs = require( 'fs' )
const path = require( 'path' )

const IS_PRODUCTION = process.env.NODE_ENV === 'production'
const DIST_PATH = path.join( __dirname, './dist/' )

module.exports = () => {
  return [{
    devtool: IS_PRODUCTION ? false : 'eval',
    entry: './src/index.js',
    optimization: {
      minimize: false,
    },
    output: {
      path: DIST_PATH,
      libraryTarget: 'commonjs2',
      filename: 'index.js',
    },
    module: {
      rules: [
        {
          test: /\.js$/,
          loader: 'babel-loader',
          exclude: /node_modules/,
        },
      ],
    },
    resolve: {
      modules: [ 'node_modules', 'src' ],
    },
  }]
}