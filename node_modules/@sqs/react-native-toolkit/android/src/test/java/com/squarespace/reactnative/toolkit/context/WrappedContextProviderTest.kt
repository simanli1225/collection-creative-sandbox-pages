package com.squarespace.reactnative.toolkit.context

import com.facebook.react.bridge.ReactContext
import com.nhaarman.mockitokotlin2.mock
import com.nhaarman.mockitokotlin2.times
import com.nhaarman.mockitokotlin2.verify
import org.junit.Before
import org.junit.Test

class WrappedContextProviderTest {

  private val mockContext: ReactContext = mock()

  private lateinit var testReactContextProvider: ReactContextProvider

  @Before
  fun setup() {
    testReactContextProvider = WrappedContextProvider(mockContext)
  }

  @Test
  fun `context is used correctly`() {
    testReactContextProvider.withContext { it.destroy() }

    verify(mockContext, times(1))
      .destroy()
  }

  @Test
  fun `context is used correctly with extension`() {
    val contextProvider = mockContext.asContextProvider()

    contextProvider.withContext { it.destroy() }

    verify(mockContext, times(1))
      .destroy()
  }
}
