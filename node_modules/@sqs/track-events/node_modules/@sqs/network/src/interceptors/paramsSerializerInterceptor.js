import qs from 'qs';

/**
 * Interceptor that overrides Axios default param serialization.
 */
export const paramsSerializerInterceptor = {
  fulfilledHandler: config => {
    if (config && config.params && Object.keys(config.params).length) {
      // convert arrays from "foo[]=a&foo[]=b" syntax to "foo=1&foo=2"
      config.paramsSerializer = params => qs.stringify(params, { arrayFormat: 'repeat' });
    }
    return config;
  },
  rejectedHandler: error => Promise.reject(error)
};

export default paramsSerializerInterceptor;