const fs = require('fs');
const path = require('path');
const { ESLint } = require('eslint');

function lintFixtures(config, fixturePath) {
  const newConfig = {
    useEslintrc: false,
    baseConfig: config,
  };

  const cli = new ESLint(newConfig);
  const fixtures = fs
    .readdirSync(fixturePath)
    .filter((filename) => /\.js|\.ts$/.test(filename));

  return fixtures.map((fileName) => {
    const code = fs.readFileSync(path.join(fixturePath, fileName)).toString();
    const result = cli.lintText(code);
    return { fileName, result };
  });
}

module.exports = {
  lintFixtures: lintFixtures,
};
