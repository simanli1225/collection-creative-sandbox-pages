const { execSync } = require('child_process');

/**
 * A utility that returns existing projects. This could subsequently
 * be used to avoid package name collisions etc
 *
 * @return Map
 */
const getExistingProjectPackages = () => {
  let packages;

  try {
    packages = JSON.parse(execSync('npx lerna ls --json').toString());
  } catch (error) {
    packages = {};
  }

  return packages.reduce((collector, packageInfo) => {
    collector.set(packageInfo.name, packageInfo);
    return collector;
  }, new Map());
};

module.exports = {
  getExistingProjectPackages
};