const path = require('path');
const { requireConfig, writeJsonFileSync } = require('../utils');
const { version } = require('../../package.json');

/**
 * Given the provided answers, update the package.json within
 * the cloned example to contain the entered information.
 *
 * @param {Object} answers PlopJs answers object
 */
module.exports = function(answers) {
  const { projectType, name, language, description, directory } = answers;
  const packageJsonPath = path.join(directory, 'package.json');

  // No spreading here, to avoid reordering.
  const packageJson = requireConfig(packageJsonPath);
  packageJson.name = name;
  packageJson.description = description;
  packageJson.version = '1.0.0';
  packageJson.starter = {
    ...answers.febsExampleRepository,
    createdAt: Date.now(),
    febsCreateVersion: version,
    generated: true,
    language,
    projectType
  };

  writeJsonFileSync(packageJsonPath, packageJson);
};